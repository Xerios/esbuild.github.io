var w=document.getElementById("outputResult"),Y=document.createElement("textarea"),ee=document.createElement("textarea"),J=document.createElement("textarea"),te=document.createElement("textarea"),ne=document.createElement("textarea"),X=[];S(Y,!0);S(ee,!0);S(J,!0);S(te,!0);S(ne,!0);function v(e){e.style.height="0",e.style.height=e.scrollHeight+1+"px"}function S(e,t=!1){e.readOnly=t,e.spellcheck=!1,e.autocapitalize="off",e.autocomplete="off"}function U(e){let t=`\x1B[31m\u2718 \x1B[41;31m[\x1B[41;97mERROR\x1B[41;31m]\x1B[0m \x1B[1m${e&&e.message||e}\x1B[0m`,r=e&&e.j,o=e&&e.se;if(r&&(t+=me(r)),o)for(let c of o)t+=`
  ${c.B}`,c.j&&(t+=me(c.j));return t}function me({te:e,E:t,T:r,Q:o,re:c,oe:i}){let n=o<2?"^":"~".repeat(o),f=`

    ${e}:${t}:${r}:
`;return f+=`\x1B[37m${t.toString().padStart(7)} \u2502 ${c.slice(0,r)}\x1B[32m${c.slice(r,r+o)}\x1B[37m${c.slice(r+o)}
`,i&&(f+=`        \u2502 ${" ".repeat(r)}\x1B[32m${n}\x1B[37m
`,n=i),f+=`        \u2575 ${" ".repeat(r)}\x1B[32m${n}\x1B[0m
`,f}function $(e,t,r){if(r!==void 0){let o=document.createElement("div");e.textContent=r.replace(/\n$/,""),o.id=t,o.className="hasLabel",o.append(e),w.append(o),v(e)}}function re({le:e,ie:t,V:r,ae:o,R:c}){if(w.innerHTML="",$(Y,"transformOutput",e),t&&$(ne,"sourceMap",t),r&&$(J,"transformMangleCache",JSON.stringify(r,null,2)),$(ee,"legalComments",o),c){let i=document.createElement("div");i.id="stderrLog",i.innerHTML=ge(c),w.append(i)}if(e===void 0&&!c){let i=document.createElement("div");i.id="outputStatus",i.textContent="(no output)",w.append(i)}}function oe({ce:e,ue:t,V:r,R:o},c){if(w.innerHTML="",X.length=0,e)for(let i of e){let n=document.createElement("div"),f=document.createElement("div"),u=document.createElement("textarea");f.className="outputPath",f.textContent=i.path.replace(/^\//,""),u.readOnly=!0,u.value=i.text.replace(/\n$/,""),S(u),n.className="buildOutput hasLabel",n.append(u),w.append(f,n),X.push(u),v(u)}if(o){let i=document.createElement("div");i.id="stderrLog",i.innerHTML=ge(o),w.append(i)}if((!e||!e.length)&&!o){let i=document.createElement("div");i.id="outputStatus",i.textContent=c?"(no output)":"(no entry points)",w.append(i)}r&&$(J,"mangleCache",JSON.stringify(r,null,2)),t&&$(te,"metafile",JSON.stringify(t,null,2))}function A(e){w.innerHTML=`<span id="outputStatus">Loading ${e?"version "+e:""}...</span>`}function pe(e){w.innerHTML="";let t=document.createElement("div");t.className="problem",t.innerHTML=`\u274C Failed to load esbuild: ${e}`,w.append(t)}function ge(e){return"<span>"+e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\033\[([^m]*)m/g,(t,r)=>{switch(r){case"1":return'</span><span class="color-bold">';case"31":return'</span><span class="color-red">';case"32":return'</span><span class="color-green">';case"33":return'</span><span class="color-yellow">';case"35":return'</span><span class="color-magenta">';case"37":return'</span><span class="color-dim">';case"41;31":return'</span><span class="bg-red color-red">';case"41;97":return'</span><span class="bg-red color-white">';case"43;33":return'</span><span class="bg-yellow color-yellow">';case"43;30":return'</span><span class="bg-yellow color-black">';case"0":return"</span><span>"}throw new Error(`Unknown escape sequence: ${r}`)})+"</span>"}addEventListener("resize",()=>{if(L===0)v(Y),v(ne),v(ee);else{for(let e of X)v(e);v(te)}v(J)});function F(e,t){let r=e.trimStart();if(!r)return{};if(/^{|^\/[*/]/.test(r))return Se(e);let o=n=>{if(i[n]!==void 0)try{i[n]=new RegExp(i[n]+"")}catch(f){throw n=n.replace(/[A-Z]/g,u=>"-"+u.toLowerCase()),new Error(`Invalid regular expression for "--${n}=": ${f.message}`)}},c=n=>{i[n]!==void 0&&(i[n]=(i[n]+"").split(","))},i=Be(e,t);return o("mangleProps"),o("reserveProps"),c("resolveExtensions"),c("mainFields"),c("conditions"),c("target"),i}function Be(e,t){let r=[],o=e.length,c=0,i=0,n=0;for(;n<o;){let a=n,h=c,p=n-i,d="",l=e[n];if(l===" "||l==="	"||l===`
`){n++,l===`
`&&(c++,i=n);continue}for(;n<o&&(l=e[n],!(l===" "||l==="	"||l===`
`));)if(n++,l==="\\"&&n<o)l=e[n++],l===`
`?(c++,i=n):d+=l;else if(l==="'"){let m=c,P=n-i-1;for(;n===o&&se(e,"'",m,P,c,n-i),l=e[n++],l!=="'";){if(l==="\\"&&n<o&&e[n]!=="'"&&(l=e[n++],l===`
`)){c++,i=n;continue}l===`
`&&(c++,i=n),d+=l}}else if(l==='"'){let m=c,P=n-i-1;for(;n===o&&se(e,'"',m,P,c,n-i),l=e[n++],l!=='"';){if(l==="\\"&&n<o&&(l=e[n++],l===`
`)){c++,i=n;continue}l===`
`&&(c++,i=n),d+=l}}else d+=l;r.push({B:d,E:h,T:p,Q:n-a})}let f=[],u=Object.create(null),s=(a,h)=>(a!==a.toLowerCase()&&x(e,"Invalid CLI-style flag: "+JSON.stringify("--"+a),h.E,h.T,a.length+2),a.replace(/-(\w)/g,(p,d)=>d.toUpperCase()));for(let{B:a,...h}of r)if(a.startsWith("--")){let p=a.indexOf(":"),d=a.indexOf("=");if(p>=0&&d<0){let l=s(a.slice(2,p),h),m=a.slice(p+1);(!(l in u)||!Array.isArray(u[l]))&&(u[l]=[]),u[l].push(m)}else if(p>=0&&p<d){let l=s(a.slice(2,p),h),m=a.slice(p+1,d),P=a.slice(d+1);(!(l in u)||typeof u[l]!="object"||Array.isArray(u[l]))&&(u[l]=Object.create(null)),u[l][m]=P}else if(d>=0){let l=a.slice(d+1);u[s(a.slice(2,d),h)]=l==="true"?!0:l==="false"?!1:l}else u[s(a.slice(2),h)]=!0}else a.startsWith("-")||t===0?x(e,'All CLI-style flags must start with "--"',h.E,h.T,h.Q):f.push(a);return f.length&&(u.entryPoints=f),u}function Se(e){let t=()=>{let p=a.v===10?"string":(a.v===8?"identifier ":"")+JSON.stringify(a.B);return x(e,`Unexpected ${p} in ${i}`,a.E,a.T,a.B.length)},r=(p,d,l)=>x(e,`Expected "${d}" after ${l} in ${i}`,p.E,p.T+p.B.length,0,"",0,0,0,d),o=(p=!1)=>{for(;s<n;){let d=f,l=s-u,m=e[s];if(m===`
`){f++,u=++s;continue}if(m===" "||m==="	"){s++;continue}if(m==="/"){let B=s++;if(s<n&&e[s]==="/"){for(s++;s<n&&e[s]!==`
`;)s++;continue}if(s<n&&e[s]==="*"){for(s++;;)if(s===n&&x(e,'Expected "*/" to terminate multi-line comment',f,s-u,0,"The multi-line comment starts here:",d,l,2,"*/"),m=e[s++],m===`
`)f++,u=s;else if(m==="*"&&s<n&&e[s]==="/"){s++;break}continue}let g=0;for(;(s===n||e[s]===`
`)&&(g?x(e,'Expected "]" to terminate character class',f,s-u,0,"The character class starts here:",f,g-u,1,"]"):x(e,'Expected "/" to terminate regular expression',f,s-u,0,"The regular expression starts here:",d,l,1,"/")),m=e[s++],!(m==="/"&&!g);)m==="]"&&g?g=0:m==="["?g=s-1:m==="\\"&&s<n&&e[s]!==`
`&&s++;for(;s<n&&/\w/.test(e[s]);)s++;let b=e.slice(B,s),y;try{y=(0,eval)(b)}catch{x(e,`Invalid regular expression in ${i}`,d,l,s-B)}a={E:d,T:l,v:9,B:b,k:y};return}p&&x(e,`Expected end of file after ${i}`,f,s-u,0);let P="-,:[]{}+".indexOf(m);if(P>=0){s++,a={E:d,T:l,v:P,B:m,k:m};return}if(m==="."||m>="0"&&m<="9"){let B=/^[\.\w]$/,g=s++;for(;s<n&&B.test(e[s]);)s++;let b=e.slice(g,s);if(!/\d/.test(b))s=g;else{let y=+b;y!==y&&x(e,`Invalid number "${b}" in ${i}`,d,l,s-g),a={E:d,T:l,v:9,B:b,k:y};return}}let fe=/^[\w\$]$/;if(fe.test(m)){let B=s++;for(;s<n&&fe.test(e[s]);)s++;let g=e.slice(B,s),b=9,y=g;g==="null"?y=null:g==="true"?y=!0:g==="false"?y=!1:g==="undefined"?y=void 0:g==="Infinity"?y=1/0:g==="NaN"?y=NaN:b=8,a={E:d,T:l,v:b,B:g,k:y};return}if(m==='"'||m==="'"){let B=s++;for(;;)if((s===n||e[s]===`
`)&&se(e,m,d,l,f,s-u),e[s]==="\\"&&s+1<n)s+=2,e[s-1]===`
`&&(f++,u=s);else if(e[s++]===m)break;let g=e.slice(B,s),b;try{b=(0,eval)(g)}catch{x(e,`Invalid string in ${i}`,d,l,s-B)}a={E:d,T:l,v:10,B:g,k:b};return}x(e,`Unexpected ${JSON.stringify(m)} in ${i}`,f,s-u,1)}p||x(e,`Unexpected end of file in ${i}`,f,s-u,0)},c=()=>{if(a.v===5){let p=Object.create(null);for(;o(),a.v!==6;){a.v!==10&&a.v!==8&&t();let d=a;o(),a.v!==2&&r(d,":","property "+JSON.stringify(d.k)),o(),p[d.k]=c();let l=a;if(o(),a.v===6)break;a.v!==1&&r(l,",","property "+JSON.stringify(d.k))}return p}if(a.v===3){let p=[],d=0;for(;o(),a.v!==4;)if(a.v!==1){p[d++]=c();let l=a;if(o(),a.v===4)break;a.v!==1&&r(l,",","array element")}else p.length=++d;return p}return a.v===9||a.v===10?a.k:a.v===7?(o(),+c()):a.v===0?(o(),-c()):t()},i="JSON5 value",n=e.length,f=0,u=0,s=0,a;o();let h=c();return o(!0),h}function x(e,t,r,o,c,i="",n=0,f=0,u=0,s){let a=e.split(`
`),h=new Error(t);throw h.j={te:"<options>",E:r+1,T:o,Q:c,re:a[r],oe:s},i&&(h.se=[{B:i,j:{te:"<options>",E:n+1,T:f,Q:u,re:a[n]}}]),h}function se(e,t,r,o,c,i){let n=t==='"'?"double":"single";x(e,`Failed to find the closing ${n} quote`,c,i,0,`The opening ${n} quote is here:`,r,o,1,t)}var M=document.querySelector("#transformOptions textarea"),O=document.querySelector("#transformInput textarea");function he(){return[M.value,O.value]}function ve(e,t){(M.value!==e||O.value!==t)&&(M.value=e,O.value=t,j()),N()}function N(){v(M),v(O)}function j(){_();try{V({G:"transform",K:O.value,N:F(M.value,0)}).then(e=>{re(e)},()=>{})}catch(e){re({R:U(e)})}}M.oninput=()=>{v(M),j()};O.oninput=()=>{v(O),j()};addEventListener("resize",N);N();var L=0,ye=[document.getElementById("transformPanel"),document.getElementById("buildPanel")],Ce=document.getElementById("modeSwitcher"),z=Ce.querySelectorAll("a");z[0].onclick=()=>{W(0)&&(A(null),K())};z[1].onclick=()=>{xe(),W(1)&&(A(null),K())};function W(e){return L===e?!1:(z[L].classList.remove("active"),ye[L].style.display="none",L=e,z[L].classList.add("active"),ye[L].style.display="block",!0)}function K(){L===0?(N(),j()):(G(),k())}var be=Pe(),E=document.querySelector("#versionPicker select"),Q=document.createElement("option"),ie;Q.textContent="Loading...";E.append(Q);E.disabled=!0;be.then(e=>{let t=e.filter(r=>!/^0\.[0-4]\.|^0\.5\.0/.test(r));E.disabled=!1,Q.remove();for(let r of t){let o=document.createElement("option");o.textContent=r,E.append(o)}E.onchange=()=>ie(E.value),E.selectedIndex=-1},()=>{Q.textContent="\u274C Loading failed!"});function Ee(){return E.disabled||E.selectedIndex<0?null:E.value}function ae(e){ie=e}async function q(e){let t=await be,r=e==="latest"&&t.length?0:t.indexOf(e);r>=0&&E.selectedIndex!==r&&(E.selectedIndex=r,await ie(t[r]))}async function Pe(){try{let e="https://data.jsdelivr.com/v1/package/npm/esbuild-wasm",t=(await fetch(e).then(r=>r.json())).versions;if(t&&t.length)return console.log(`Loaded ${t.length} versions from ${e}`),t}catch(e){console.error(e)}try{let e="https://registry.npmjs.org/esbuild-wasm",t=(await fetch(e).then(r=>r.json())).versions;if(t&&(t=Object.keys(t).reverse(),t.length))return console.log(`Loaded ${t.length} versions from ${e}`),t}catch(e){console.error(e)}throw new Error}var Me=fetch("worker.js").then(e=>e.text()),I=null,C=null,Z=new Promise((e,t)=>{ae(r=>{let o=we(r);return o.then(e,t),ae(c=>(Z.then(i=>i.terminate()),Z=we(c),Z)),o})});async function Te(e){try{let t=await fetch(`https://cdn.jsdelivr.net/npm/${e}`);if(t.ok)return t}catch{}return fetch(`https://unpkg.com/${e}`)}async function we(e){let t;A(e);try{I&&I.X(),C&&C.X(),I=null,C=null;let[r,o,c]=e.split(".").map(a=>+a),i=r===0&&(o<8||o===8&&c<33)?"":".min",[n,f,u]=await Promise.all([Me,Te(`esbuild-wasm@${e}/lib/browser${i}.js`).then(a=>a.text()),Te(`esbuild-wasm@${e}/esbuild.wasm`).then(a=>a.arrayBuffer())]),s=URL.createObjectURL(new Blob([f,`
`,n],{type:"application/javascript"}));return await new Promise((a,h)=>{let p=new Worker(s);p.onmessage=d=>{if(d.data.H==="slow"){let l=document.getElementById("slowWarning");l.innerHTML="<span>\u26A0\uFE0F Processing is slow because </span><span>WebAssembly is disabled \u26A0\uFE0F</span>",l.style.display="flex";return}p.onmessage=null,d.data.H==="success"?(a(p),K()):(h(new Error("Failed to create worker")),t=d.data.fe),URL.revokeObjectURL(s)},p.postMessage([e,u],[u])})}catch(r){throw pe(t||r+""),r}}function V(e){function t(r,o){I?(C&&C.X(),C=o):(I=o,r.onmessage=c=>{r.onmessage=null,o.de(c.data),I=null,C&&(t(r,C),C=null)},r.postMessage(o.me))}return new Promise((r,o)=>{Z.then(c=>t(c,{me:e,de:r,X:()=>o(new Error("Task aborted"))}),o)})}var H=document.querySelector("#buildOptions textarea"),le=document.getElementById("addInput"),Oe=document.getElementById("buildInputs"),T=[];function ce(){return[H.value,T.map(e=>({Z:e.U.classList.contains("entryPoint"),Y:e.z.value.trim(),A:e.W.value}))]}function Le(e,t){if(JSON.stringify([e,t])!==JSON.stringify(ce())){for(let r of T)r.U.remove();T.length=0,H.value=e;for(let r of t)de(r.Z,r.Y,r.A);R(),k()}G()}function xe(){T.length||de(!0,ue())}function G(){v(H);for(let e of T)v(e.W)}function k(){_();try{let e=F(H.value,1),t=Array.isArray(e.entryPoints)?e.entryPoints:e.entryPoints=[],r=Object.create(null),o=Object.create(null),c;for(let i of T){let n=i.z.value.trim();if((o[n]||(o[n]=[])).push(i),n)r[n]=i.W.value,i.U.classList.contains("entryPoint")&&!t.includes(n)&&t.push(n);else{let u=e.stdin&&typeof e.stdin=="object"?e.stdin:e.stdin={};u.contents=i.W.value,"resolveDir"in u||(u.resolveDir="/")}}for(let i in o){let n=o[i];if(n.length>1){for(let f of n)f.U.classList.add("duplicate");c||(c=new Error("Duplicate input file: "+(i?JSON.stringify(i):"<stdin>")))}else n[0].U.classList.remove("duplicate")}if(c)throw c;V({G:"build",K:r,N:e}).then(i=>{oe(i,t.length)},()=>{})}catch(e){oe({R:U(e)},-1)}}function ue(){if(!T.length)return"entry.js";let e=1,t="file.js";for(;T.some(r=>r.z.value.trim()===t);)t=`file${++e}.js`;return t}function R(){le.textContent="+ "+ue()}function de(e=!1,t="",r=""){let o=document.createElement("div"),c=document.createElement("a"),i=document.createElement("a"),n=document.createElement("input"),f=document.createElement("div"),u=document.createElement("textarea"),s={U:o,z:n,W:u};return S(n),S(u),n.placeholder="<stdin>",n.value=t,c.className="entryToggle",c.textContent="",c.href="javascript:void 0",i.className="remove",i.textContent="\xD7",i.href="javascript:void 0",u.placeholder="(enter your code here)",u.value=r,o.className="buildInput",e&&o.classList.add("entryPoint"),f.className="hasLabel",f.append(u),o.append(c,n,i,f),Oe.insertBefore(o,le),n.oninput=()=>{R(),k()},n.onblur=()=>{let a=n.value.trim();n.value!==a&&(n.value=a,R(),k())},u.oninput=()=>{v(u),k()},c.onclick=()=>{o.classList.toggle("entryPoint"),k()},i.onclick=()=>{let a=T.indexOf(s);a<0||(T.splice(a,1),o.remove(),R(),k())},T.push(s),R(),v(u),s}H.oninput=()=>{v(H),k()};le.onclick=()=>{let e=de(!T.length,ue());e.z.focus(),e.z.select(),k()};addEventListener("resize",G);R();function ke(){let e=location.hash,t=atob(e.slice(1)).split("\0");if(t[0]==="t"&&t.length===4)return W(0),ve(t[2],t[3]),q(t[1]),!0;if(t[0]==="b"&&t.length%3===0){let r=[];for(let o=3;o<t.length;o+=3)r.push({Z:t[o]==="e",Y:t[o+1],A:t[o+2]});return W(1),Le(t[2],r),q(t[1]),!0}if(location.hash!=="")try{history.replaceState({},"",location.pathname)}catch{}return!1}function _(){let e=Ee();if(!e)return;let t;if(L===0){let[r,o]=he();(r||o)&&(t=["t",e,r,o])}else{let[r,o]=ce();t=["b",e,r];for(let c of o)t.push(c.Z?"e":"",c.Y,c.A)}try{let r=t?"#"+btoa(t.join("\0")).replace(/=+$/,""):"";location.hash!==r&&history.replaceState({},"",r||location.pathname)}catch{if(location.hash!=="")try{history.replaceState({},"",location.pathname)}catch{}}}ke()||q("latest");
